"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[459],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>m});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=n.createContext({}),s=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},d=function(e){var t=s(e.components);return n.createElement(p.Provider,{value:t},e.children)},c="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),c=s(a),u=r,m=c["".concat(p,".").concat(u)]||c[u]||h[u]||o;return a?n.createElement(m,i(i({ref:t},d),{},{components:a})):n.createElement(m,i({ref:t},d))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=u;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[c]="string"==typeof e?e:r,i[1]=l;for(var s=2;s<o;s++)i[s]=a[s];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},9822:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>l,toc:()=>s});var n=a(7462),r=(a(7294),a(3905));const o={sidebar_position:3,title:"\ud83d\udee4\ufe0f Multiple Deployment Tracks",description:"Push patches to multiple deployment tracks"},i="Multiple Deployment Tracks",l={unversionedId:"guides/multiple_deployment_tracks",id:"guides/multiple_deployment_tracks",title:"\ud83d\udee4\ufe0f Multiple Deployment Tracks",description:"Push patches to multiple deployment tracks",source:"@site/docs/guides/multiple_deployment_tracks.md",sourceDirName:"guides",slug:"/guides/multiple_deployment_tracks",permalink:"/guides/multiple_deployment_tracks",draft:!1,editUrl:"https://github.com/shorebirdtech/docs/tree/main/docs/guides/multiple_deployment_tracks.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,title:"\ud83d\udee4\ufe0f Multiple Deployment Tracks",description:"Push patches to multiple deployment tracks"},sidebar:"tutorialSidebar",previous:{title:"\ud83d\udea2 Release a Code Push App",permalink:"/guides/code_push_release"},next:{title:"\u2795 Code Push Add to App",permalink:"/guides/code_push_add_to_app"}},p={},s=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Create a Project",id:"create-a-project",level:2},{value:"Configure Flavors",id:"configure-flavors",level:2},{value:"Initialize Shorebird",id:"initialize-shorebird",level:2},{value:"Create a release",id:"create-a-release",level:2},{value:"Preview the release",id:"preview-the-release",level:2},{value:"Promote the patch",id:"promote-the-patch",level:2}],d={toc:s},c="wrapper";function h(e){let{components:t,...a}=e;return(0,r.kt)(c,(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"multiple-deployment-tracks"},"Multiple Deployment Tracks"),(0,r.kt)("p",null,"This guide will walk through how to setup an app in which there are 2 deployment tracks: ",(0,r.kt)("inlineCode",{parentName:"p"},"internal")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"stable"),". It will cover how to validate a patch on the internal track and then promote the patch to the stable track."),(0,r.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,r.kt)("p",null,"This guide assumes the Shorebird CLI is installed on your machine and that you are logged into an account. Refer to the ",(0,r.kt)("a",{parentName:"p",href:"/"},"getting started")," instructions for more information."),(0,r.kt)("h2",{id:"create-a-project"},"Create a Project"),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"In this guide, we'll go through the process of creating a new project from scratch. To apply these changes to an existing project, skip this step and read ahead.")),(0,r.kt)("p",null,"Create a new project using ",(0,r.kt)("inlineCode",{parentName:"p"},"flutter create multiple_deployments"),"."),(0,r.kt)("h2",{id:"configure-flavors"},"Configure Flavors"),(0,r.kt)("p",null,"Next, edit the ",(0,r.kt)("inlineCode",{parentName:"p"},"android/app/build.gradle")," to contain two productFlavors:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-diff"},'defaultConfig {\n    ...\n}\n\n+    flavorDimensions "track"\n+    productFlavors {\n+        internal {\n+            dimension "track"\n+            applicationIdSuffix ".internal"\n+            manifestPlaceholders = [applicationLabel: "[Internal] Shorebird Example"]\n+        }\n+        stable {\n+            dimension "track"\n+            manifestPlaceholders = [applicationLabel: "Shorebird Example"]\n+        }\n+    }\n\nbuildTypes {\n  ...\n}\n')),(0,r.kt)("p",null,"Lastly, edit ",(0,r.kt)("inlineCode",{parentName:"p"},"android/app/src/main/AndroidManifest.xml")," to use the ",(0,r.kt)("inlineCode",{parentName:"p"},"applicationLabel")," so that we can differentiate the two apps easily:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-diff"},'<manifest xmlns:android="http://schemas.android.com/apk/res/android">\n-  <application android:label="multiple_deployments" android:name="${applicationName}" android:icon="@mipmap/ic_launcher">\n+  <application android:label="${applicationLabel}" android:name="${applicationName}" android:icon="@mipmap/ic_launcher">\n')),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"To learn more about configuring ",(0,r.kt)("inlineCode",{parentName:"p"},"productFlavors")," refer to the ",(0,r.kt)("a",{parentName:"p",href:"https://developer.android.com/build/build-variants#product-flavors"},"Android Developer documentation"),".")),(0,r.kt)("h2",{id:"initialize-shorebird"},"Initialize Shorebird"),(0,r.kt)("p",null,"Next, initialize shorebird in the current project via ",(0,r.kt)("inlineCode",{parentName:"p"},"shorebird init"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"shorebird init\n")),(0,r.kt)("p",null,"The generated ",(0,r.kt)("inlineCode",{parentName:"p"},"shorebird.yaml")," should look something like:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"# This file is used to configure the Shorebird updater used by your application.\n# Learn more at https://shorebird.dev\n# This file should be checked into version control.\n\n# This is the unique identifier assigned to your app.\n# It is used by your app to request the correct patches from Shorebird servers.\napp_id: ee322dc4-3dc2-4324-90a9-04c40a62ae76\nflavors:\n  internal: ee322dc4-3dc2-4324-90a9-04c40a62ae76\n  stable: 904bd3d5-3526-4c1c-a832-7ac23c95302d\n")),(0,r.kt)("p",null,"Since the project contains flavors, ",(0,r.kt)("inlineCode",{parentName:"p"},"shorebird init")," generates an app per flavor."),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"You can list your shorebird apps via ",(0,r.kt)("inlineCode",{parentName:"p"},"shorebird apps list"),". In this case, the output should look something like:"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre"},"$ shorebird apps list\n\ud83d\udcf1 Apps\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Name                            \u2502 ID                                   \u2502 Release \u2502 Patch \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 multiple_deployments (internal) \u2502 ee322dc4-3dc2-4324-90a9-04c40a62ae76 \u2502 --      \u2502 --    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 multiple_deployments (stable)   \u2502 904bd3d5-3526-4c1c-a832-7ac23c95302d \u2502 --      \u2502 --    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"))),(0,r.kt)("p",null,"Before moving on, run ",(0,r.kt)("inlineCode",{parentName:"p"},"shorebird doctor")," to ensure the project is configured correctly."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"shorebird doctor\n")),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Use ",(0,r.kt)("inlineCode",{parentName:"p"},"shorebird doctor --fix")," to automatically fix validation issues detected. If you just created a new project, you'll need to do this in order to add the missing internet permission to the ",(0,r.kt)("inlineCode",{parentName:"p"},"AndroidManifest.xml"),".")),(0,r.kt)("h2",{id:"create-a-release"},"Create a release"),(0,r.kt)("p",null,"Now that we've created our apps on shorebird, we need to create releases (one for each track). To create a release, we'll use the ",(0,r.kt)("inlineCode",{parentName:"p"},"shorebird release android")," command."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"# Create a release for the internal track\nshorebird release android --flavor internal\n\n# Create a release for the stable track\nshorebird release android --flavor stable\n")),(0,r.kt)("p",null,"We can verify the releases were created successfully by re-running ",(0,r.kt)("inlineCode",{parentName:"p"},"shorebird apps list"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"$ shorebird apps list\n\ud83d\udcf1 Apps\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Name                            \u2502 ID                                   \u2502 Release \u2502 Patch \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 multiple_deployments (internal) \u2502 ee322dc4-3dc2-4324-90a9-04c40a62ae76 \u2502 1.0.0+1 \u2502 --    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 multiple_deployments (stable)   \u2502 904bd3d5-3526-4c1c-a832-7ac23c95302d \u2502 1.0.0+1 \u2502 --    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n")),(0,r.kt)("h2",{id:"preview-the-release"},"Preview the release"),(0,r.kt)("p",null,"Next, preview the app release locally on a device or emulator, use ",(0,r.kt)("inlineCode",{parentName:"p"},"shorebird preview"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"# Preview the release for the internal track.\nshorebird preview --app-id ee322dc4-3dc2-4324-90a9-04c40a62ae76 --release-version 1.0.0+1\n\n# Preview the release for the stable track.\nshorebird preview --app-id 904bd3d5-3526-4c1c-a832-7ac23c95302d --release-version 1.0.0+1\n")),(0,r.kt)("p",null,"This will download the releases and run them on your device."),(0,r.kt)("p",null,"In addition to previewing the releases locally, you should also ",(0,r.kt)("a",{parentName:"p",href:"/guides/code_push_release#upload-to-the-play-store"},"submit the generated app bundles to the Play Store"),". In this case, both apps can be part of the internal test track and only the stable variant should be promoted to production."),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"internal")," variant should only be used for internal testing/validation."),(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"stable")," variant should be shipped to end users in production.\n:::")),(0,r.kt)("h2",{parentName:"admonition",id:"creating-a-patch"},"Creating a patch"),(0,r.kt)("p",{parentName:"admonition"},"Now that we have our internal and stable releases on the Play Store, we can create a patch using ",(0,r.kt)("inlineCode",{parentName:"p"},"shorebird patch android"),". For the sake of this example, let's adjust the app theme to use ",(0,r.kt)("inlineCode",{parentName:"p"},"deepOrange")," as the seed color in ",(0,r.kt)("inlineCode",{parentName:"p"},"lib/main.dart"),":"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-diff"},'class MyApp extends StatelessWidget {\n  const MyApp({super.key});\n\n  // This widget is the root of your application.\n  @override\n  Widget build(BuildContext context) {\n    return MaterialApp(\n      title: \'Flutter Demo\',\n      theme: ThemeData(\n        // This is the theme of your application.\n        //\n        // TRY THIS: Try running your application with "flutter run". You\'ll see\n        // the application has a blue toolbar. Then, without quitting the app,\n        // try changing the seedColor in the colorScheme below to Colors.green\n        // and then invoke "hot reload" (save your changes or press the "hot\n        // reload" button in a Flutter-supported IDE, or press "r" if you used\n        // the command line to start the app).\n        //\n        // Notice that the counter didn\'t reset back to zero; the application\n        // state is not lost during the reload. To reset the state, use hot\n        // restart instead.\n        //\n        // This works for code too, not just values: Most code changes can be\n        // tested with just a hot reload.\n-        colorScheme: ColorScheme.fromSeed(seedColor: Colors.deepPurple),\n+        colorScheme: ColorScheme.fromSeed(seedColor: Colors.deepOrange),\n        useMaterial3: true,\n      ),\n      home: const MyHomePage(title: \'Flutter Demo Home Page\'),\n    );\n  }\n}\n'))),(0,r.kt)("p",null,"Typically ",(0,r.kt)("inlineCode",{parentName:"p"},"shorebird patch")," should be used to fix critical bugs.\n:::"),(0,r.kt)("p",null,"Now that we've applied the changes, let's patch the ",(0,r.kt)("inlineCode",{parentName:"p"},"internal")," variant:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"shorebird patch android --flavor internal\n")),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Run ",(0,r.kt)("inlineCode",{parentName:"p"},"shorebird apps list")," to verify the patch was published:"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-sh"}," \ud83d\udcf1 Apps\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Name                            \u2502 ID                                   \u2502 Release \u2502 Patch \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 multiple_deployments (internal) \u2502 ee322dc4-3dc2-4324-90a9-04c40a62ae76 \u2502 1.0.0+1 \u2502 1     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 multiple_deployments (stable)   \u2502 904bd3d5-3526-4c1c-a832-7ac23c95302d \u2502 1.0.0+1 \u2502 --    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"))),(0,r.kt)("p",null,"We can validate the patch by re-launching the internal release."),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"If you are testing locally, you don't need to re-run ",(0,r.kt)("inlineCode",{parentName:"p"},"shorebird run")," -- just re-launch the app from the device or emulator directly.")),(0,r.kt)("p",null,"The first time the app is re-launched, we should still see the purple theme and shorebird will detect and install the patch in the background. Kill and re-launch the app a second time to see the applied patch."),(0,r.kt)("p",null,"If all went well, you should see the patch was applied after re-launching the app a second time. All devices that have the internal variant of the app installed should also receive the patch \ud83c\udf89"),(0,r.kt)("h2",{id:"promote-the-patch"},"Promote the patch"),(0,r.kt)("p",null,"Once you have validated the patch internally, you can promote the patch to the stable variant via:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"shorebird patch android --flavor stable\n")),(0,r.kt)("p",null,"At this point, you have a setup which allows you to push patches to internal testers before promoting them to production \ud83c\udf89"),(0,r.kt)("p",null,"The full source code for this example can be found ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/shorebirdtech/samples/tree/main/multiple_deployments"},"here"),"."))}h.isMDXComponent=!0}}]);